[gd_scene load_steps=36 format=3 uid="uid://ds0d7p7idbuc4"]

[ext_resource type="Texture2D" uid="uid://ocafxyc2n38q" path="res://assets/sprites/characters.png" id="1_h27i2"]
[ext_resource type="Script" uid="uid://1uia1xe5nmrj" path="res://scripts/entities/player.gd" id="1_mfpxk"]
[ext_resource type="Script" uid="uid://r07fqxyrf5xi" path="res://scripts/utility_scripts/camera_gimbal.gd" id="2_73kkf"]
[ext_resource type="PackedScene" uid="uid://f4fj2u87647d" path="res://scenes/components/animation_tree.tscn" id="3_n5sgd"]
[ext_resource type="Script" uid="uid://bqnr5hyceu623" path="res://addons/godot_state_charts/state_chart.gd" id="4_ss7kx"]
[ext_resource type="Script" uid="uid://bt4iqisaqggy8" path="res://addons/godot_state_charts/compound_state.gd" id="5_dnykm"]
[ext_resource type="Script" uid="uid://bm4a5s8vovnwv" path="res://addons/godot_state_charts/atomic_state.gd" id="6_c5rqy"]
[ext_resource type="Script" uid="uid://btg0k6scpejn3" path="res://addons/godot_state_charts/transition.gd" id="7_b6tgf"]
[ext_resource type="Script" uid="uid://cw43pgy3x2a52" path="res://scripts/entities/player_states/idle.gd" id="8_dnykm"]
[ext_resource type="Script" uid="uid://c7whpml006e7v" path="res://scripts/entities/player_states/moving.gd" id="9_c5rqy"]
[ext_resource type="PackedScene" uid="uid://bcwkugn6v3oy7" path="res://addons/godot_state_charts/utilities/state_chart_debugger.tscn" id="10_b6tgf"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_73kkf"]
radius = 0.05
height = 0.2

[sub_resource type="Resource" id="Resource_qhqgy"]
metadata/__load_path__ = "res://assets/sprites/down_1.tres"

[sub_resource type="Animation" id="Animation_uwb5j"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [SubResource("Resource_qhqgy")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_dqkch"]
atlas = ExtResource("1_h27i2")
region = Rect2(0, 80, 16, 16)

[sub_resource type="Animation" id="Animation_iu0qf"]
resource_name = "idle_down"
length = 0.001
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [SubResource("AtlasTexture_dqkch")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_7s3b3"]
atlas = ExtResource("1_h27i2")
region = Rect2(0, 128, 16, 16)

[sub_resource type="Animation" id="Animation_lxxd7"]
resource_name = "idle"
length = 0.001
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [SubResource("AtlasTexture_7s3b3")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_xtrvp"]
atlas = ExtResource("1_h27i2")
region = Rect2(0, 112, 16, 16)

[sub_resource type="Animation" id="Animation_61kwp"]
resource_name = "idle_right"
length = 0.001
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [SubResource("AtlasTexture_xtrvp")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_mkl1e"]
atlas = ExtResource("1_h27i2")
region = Rect2(0, 96, 16, 16)

[sub_resource type="Animation" id="Animation_lacu8"]
resource_name = "idle_up"
length = 0.001
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [SubResource("AtlasTexture_mkl1e")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_fbscx"]
atlas = ExtResource("1_h27i2")
region = Rect2(16, 80, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_mprs5"]
atlas = ExtResource("1_h27i2")
region = Rect2(32, 80, 16, 16)

[sub_resource type="Animation" id="Animation_8kmrx"]
resource_name = "run_down"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.25, 0.5, 0.75, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [SubResource("AtlasTexture_fbscx"), SubResource("AtlasTexture_mprs5"), SubResource("AtlasTexture_fbscx"), SubResource("AtlasTexture_mprs5"), SubResource("AtlasTexture_mprs5")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_pkm0b"]
atlas = ExtResource("1_h27i2")
region = Rect2(16, 128, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_xki6w"]
atlas = ExtResource("1_h27i2")
region = Rect2(32, 128, 16, 16)

[sub_resource type="Animation" id="Animation_qkacx"]
resource_name = "run_left"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.25, 0.5, 0.75, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [SubResource("AtlasTexture_pkm0b"), SubResource("AtlasTexture_xki6w"), SubResource("AtlasTexture_pkm0b"), SubResource("AtlasTexture_xki6w"), SubResource("AtlasTexture_pkm0b")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_lmhhu"]
atlas = ExtResource("1_h27i2")
region = Rect2(16, 112, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_xx1cp"]
atlas = ExtResource("1_h27i2")
region = Rect2(32, 112, 16, 16)

[sub_resource type="Animation" id="Animation_cloj4"]
resource_name = "run_right"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.25, 0.5, 0.75, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [SubResource("AtlasTexture_lmhhu"), SubResource("AtlasTexture_xx1cp"), SubResource("AtlasTexture_lmhhu"), SubResource("AtlasTexture_xx1cp"), SubResource("AtlasTexture_lmhhu")]
}

[sub_resource type="AtlasTexture" id="AtlasTexture_05cng"]
atlas = ExtResource("1_h27i2")
region = Rect2(16, 96, 16, 16)

[sub_resource type="AtlasTexture" id="AtlasTexture_58ukd"]
atlas = ExtResource("1_h27i2")
region = Rect2(32, 96, 16, 16)

[sub_resource type="Animation" id="Animation_2rpdo"]
resource_name = "run_up"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Animation:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.25, 0.5, 0.75, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 1,
"values": [SubResource("AtlasTexture_05cng"), SubResource("AtlasTexture_58ukd"), SubResource("AtlasTexture_05cng"), SubResource("AtlasTexture_58ukd"), SubResource("AtlasTexture_05cng")]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_1qls1"]
_data = {
&"RESET": SubResource("Animation_uwb5j"),
&"idle_down": SubResource("Animation_iu0qf"),
&"idle_left": SubResource("Animation_lxxd7"),
&"idle_right": SubResource("Animation_61kwp"),
&"idle_up": SubResource("Animation_lacu8"),
&"run_down": SubResource("Animation_8kmrx"),
&"run_left": SubResource("Animation_qkacx"),
&"run_right": SubResource("Animation_cloj4"),
&"run_up": SubResource("Animation_2rpdo")
}

[node name="Player" type="CharacterBody3D" groups=["player"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.08, 0)
collision_layer = 3
script = ExtResource("1_mfpxk")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_73kkf")

[node name="Animation" type="Sprite3D" parent="."]
modulate = Color(0.5, 0.5, 0.5, 1)
billboard = 1
shaded = true
texture_filter = 0
region_rect = Rect2(0, 80, 16, 16)

[node name="CameraGimbal" type="Node3D" parent="."]
script = ExtResource("2_73kkf")

[node name="InnerGimbal" type="Node3D" parent="CameraGimbal"]
transform = Transform3D(1, 0, 0, 0, 0.866025, 0.5, 0, -0.5, 0.866025, 0, 2.13833, 3.08009)

[node name="Camera3D" type="Camera3D" parent="CameraGimbal/InnerGimbal"]
fov = 45.0

[node name="AnimationTree" parent="." instance=ExtResource("3_n5sgd")]

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_1qls1")
}
autoplay = "idle_down"

[node name="StateChart" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("4_ss7kx")
metadata/_custom_type_script = "uid://bqnr5hyceu623"

[node name="Root" type="Node" parent="StateChart"]
script = ExtResource("5_dnykm")
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="StateChart/Root"]
script = ExtResource("6_c5rqy")

[node name="ToMoving" type="Node" parent="StateChart/Root/Idle"]
script = ExtResource("7_b6tgf")
to = NodePath("../../Moving")
event = &"player_moved"
delay_in_seconds = "0.0"

[node name="Moving" type="Node" parent="StateChart/Root"]
script = ExtResource("6_c5rqy")

[node name="Transition" type="Node" parent="StateChart/Root/Moving"]
script = ExtResource("7_b6tgf")
to = NodePath("../../Idle")
event = &"player_stopped"
delay_in_seconds = "0.0"

[node name="Interacting" type="Node" parent="StateChart/Root"]
script = ExtResource("6_c5rqy")

[node name="Fighting" type="Node" parent="StateChart/Root"]
script = ExtResource("6_c5rqy")

[node name="StatesLogic" type="Node" parent="."]

[node name="Idle" type="Node" parent="StatesLogic"]
script = ExtResource("8_dnykm")

[node name="Moving" type="Node" parent="StatesLogic"]
script = ExtResource("9_c5rqy")

[node name="StateChartDebugger" parent="." instance=ExtResource("10_b6tgf")]
anchors_preset = 0
anchor_right = 0.0
anchor_bottom = 0.0
offset_right = 476.0
offset_bottom = 513.0
grow_horizontal = 1
grow_vertical = 1
initial_node_to_watch = NodePath("../StateChart")

[node name="AudioListener3D" type="AudioListener3D" parent="."]
current = true

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="."]

[connection signal="state_physics_processing" from="StateChart/Root/Idle" to="StatesLogic/Idle" method="_on_idle_state_physics_processing"]
[connection signal="state_physics_processing" from="StateChart/Root/Moving" to="StatesLogic/Moving" method="_on_moving_state_physics_processing"]
